# AWS EC2 F2 run farm hosts recipe - SPOT INSTANCES
# For testing/development with reduced costs.
# Use aws_ec2_f2.yaml for production workloads.
#
# WARNING: Spot instances can be interrupted at any time!
# Only use for testing or workloads that can tolerate interruption.

run_farm_type: AWSEC2F2
args:
    # managerinit arg start
    run_farm_tag: f2spotrunfarm
    always_expand_run_farm: true
    launch_instances_timeout_minutes: 60
    # Use SPOT instances for cost savings
    run_instance_market: spot
    spot_interruption_behavior: terminate
    spot_max_price: ondemand
    default_simulation_dir: /home/centos

    # Start with smallest F2 instance for testing
    run_farm_hosts_to_use:
      - f2.2xlarge: 1
      - m4.16xlarge: 0
      - z1d.3xlarge: 0
    # managerinit arg end

    run_farm_host_specs:
      - f2.2xlarge: # 1 FPGA, 8 vCPUs, 32 GB RAM - smallest F2
          num_fpgas: 1
          num_metasims: 0
          use_for_switch_only: false
      - f2.4xlarge: # 1 FPGA, 16 vCPUs, 64 GB RAM
          num_fpgas: 1
          num_metasims: 0
          use_for_switch_only: false
      - f2.6xlarge: # 2 FPGAs, 24 vCPUs, 96 GB RAM
          num_fpgas: 2
          num_metasims: 0
          use_for_switch_only: false
      - m4.16xlarge:
          num_fpgas: 0
          num_metasims: 0
          use_for_switch_only: true
      - z1d.3xlarge:
          num_fpgas: 0
          num_metasims: 1
          use_for_switch_only: false
